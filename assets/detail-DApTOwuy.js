var ne=Object.defineProperty;var L=Object.getOwnPropertySymbols;var ie=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var T=(u,l,a)=>l in u?ne(u,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):u[l]=a,D=(u,l)=>{for(var a in l||(l={}))ie.call(l,a)&&T(u,a,l[a]);if(L)for(var a of L(l))re.call(l,a)&&T(u,a,l[a]);return u};var f=(u,l,a)=>new Promise((C,b)=>{var I=c=>{try{_(a.next(c))}catch(p){b(p)}},i=c=>{try{_(a.throw(c))}catch(p){b(p)}},_=c=>c.done?C(c.value):Promise.resolve(c.value).then(I,i);_((a=a.apply(u,l)).next())});import{_ as ce,u as ue,g as pe,r as o,J as de,x as me,Y as ge,d,M as fe,c as N,o as k,s as M,l as _e,e as $,f as t,N as F,h as r,k as S,O as ve,E as he,D as z}from"./index-BxoItr7S.js";import be from"./index-B_oFCXxs.js";import ye from"./index-CmaQYcJb.js";import{b as we,c as ke,e as ze,f as De}from"./index-Dkuq7Rgj.js";import{g as Se}from"./user-BXa85Bq3.js";import"./index-B6tTlV03.js";import"./index-CmtOAOSu.js";const Ce={class:"app-container"},Ie={class:"list-container"},xe=["src","onClick"],Ne={key:1},Ve={class:"dialog-footer"},Pe={__name:"detail",setup(u){const l=ue(),{proxy:a}=pe(),{sys_shoe_size:C}=a.useDict("sys_shoe_size"),b=o([{type:"select",prop:"size",label:"尺码",placeholder:"请选择尺码",options:[]}]),I=o([{type:"input",prop:"size",label:"尺码",width:24,formItemProps:{placeholder:"请输入尺码"},rule:[{required:!0,message:"请输入尺码",trigger:"blur"}]},{type:"input",prop:"price",label:"价格",width:24,formItemProps:{placeholder:"请输入价格"},rule:[{required:!0,message:"请输入价格",trigger:"blur"}]},{type:"input",prop:"stock",label:"库存",width:24,formItemProps:{placeholder:"请输入库存"},rule:[{required:!0,message:"请输入库存",trigger:"blur"}]}]),i=de({tableData:[],total:0,formData:{}}),_=o([]),c=o(!0);o(!1);const p=o({pageNum:1,pageSize:10}),x=o({}),y=o(!1),V=o(!0),R=o({}),w=o(""),v=o(!1),P=o(null),A=o(!1),H=o("");o("0");const J=o([]),O=()=>f(this,null,function*(){let e=yield Se();R.value=e.data}),h=()=>f(this,null,function*(){y.value=!0,x.value.articleNumber=l.query.articleNumber;try{let e=yield we(D(D({},p.value),x.value));i.tableData=e.rows,i.total=e.total,y.value=!1}catch(e){y.value=!1}}),Q=e=>f(this,null,function*(){y.value=!0,x.value=e,h()}),Y=e=>{_.value=e.map(s=>s.size),V.value=!e.length},j=()=>{w.value="新增尺码",v.value=!0},G=e=>{w.value="修改尺码",v.value=!0,i.formData=D({},e),i.formData.oldSize=e.size},q=e=>{he.confirm("是否确认删除该报账信息？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>f(this,null,function*(){let s=l.query.shoeId,m=e.size?[e.size]:_.value;yield ke({shoeId:s,sizes:m}),h(),z({type:"success",message:"删除成功"})})).catch(()=>{z({type:"info",message:"取消删除"})})},K=()=>f(this,null,function*(){P.value.submitRef().then(e=>f(this,null,function*(){e&&(v.value=!1,i.formData.shoeId=l.query.shoeId,w.value=="新增尺码"?(yield ze(i.formData),z.success("新增成功")):w.value=="修改尺码"&&(yield De(i.formData),z.success("修改成功")),h())}))}),W=()=>{v.value=!1,z.info("取消")},X=()=>{i.formData={}},Z=(e,s)=>{J.value=[{url:e}],H.value=s,A.value=!0};return me(()=>f(this,null,function*(){yield O(),yield h()})),ge(()=>{b.value.find(e=>e.prop=="size").options=C.value}),(e,s)=>{const m=d("el-button"),B=d("el-col"),ee=d("right-toolbar"),te=d("el-row"),g=d("el-table-column"),U=d("el-tooltip"),ae=d("el-table"),oe=d("pagination"),le=d("el-dialog"),se=fe("loading");return k(),N("div",Ce,[c.value?(k(),M(be,{key:0,settings:b.value,onHandleSearch:Q},null,8,["settings"])):_e("",!0),$("div",Ie,[t(te,{gutter:10,class:"mb8"},{default:r(()=>[t(B,{span:1.5},{default:r(()=>[t(m,{type:"primary",plain:"",icon:"Plus",onClick:j},{default:r(()=>[S("新增")]),_:1})]),_:1}),t(B,{span:1.5},{default:r(()=>[t(m,{type:"danger",plain:"",icon:"Delete",disabled:V.value,onClick:q},{default:r(()=>[S("删除")]),_:1},8,["disabled"])]),_:1}),t(ee,{showSearch:c.value,"onUpdate:showSearch":s[0]||(s[0]=n=>c.value=n),onQueryTable:h},null,8,["showSearch"])]),_:1}),F((k(),M(ae,{data:i.tableData,onSelectionChange:Y},{default:r(()=>[t(g,{type:"selection",width:"50",align:"center"}),t(g,{label:"货号",align:"center",prop:"articleNumber"}),t(g,{label:"品牌",align:"center",prop:"classifyId"}),t(g,{label:"图片",align:"center",prop:"photo"},{default:r(n=>[n.row.photo?(k(),N("img",{key:0,src:n.row.photo,style:{width:"60px",height:"60px",cursor:"pointer"},onClick:E=>Z(n.row.photo)},null,8,xe)):(k(),N("span",Ne,"暂无"))]),_:1}),t(g,{label:"尺码",align:"center",prop:"size"}),t(g,{label:"价格",align:"center",prop:"price"}),t(g,{label:"库存",align:"center",prop:"stock"}),t(g,{label:"操作",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:r(n=>[t(U,{content:"修改",placement:"top"},{default:r(()=>[t(m,{link:"",type:"primary",icon:"Edit",onClick:E=>G(n.row)},null,8,["onClick"])]),_:2},1024),t(U,{content:"删除",placement:"top"},{default:r(()=>[t(m,{link:"",type:"primary",icon:"Delete",onClick:E=>q(n.row)},null,8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[se,y.value]]),F(t(oe,{total:i.total,page:p.value.pageNum,"onUpdate:page":s[1]||(s[1]=n=>p.value.pageNum=n),limit:p.value.pageSize,"onUpdate:limit":s[2]||(s[2]=n=>p.value.pageSize=n),onPagination:h},null,8,["total","page","limit"]),[[ve,i.total>0]])]),t(le,{title:w.value,modelValue:v.value,"onUpdate:modelValue":s[4]||(s[4]=n=>v.value=n),width:"40%",onClosed:X,draggable:""},{footer:r(()=>[$("div",Ve,[t(m,{type:"primary",onClick:K},{default:r(()=>[S("确 定")]),_:1}),t(m,{onClick:W},{default:r(()=>[S("取 消")]),_:1})])]),default:r(()=>[t(ye,{settings:I.value,modelValue:i.formData,"onUpdate:modelValue":s[3]||(s[3]=n=>i.formData=n),ref_key:"base_form",ref:P},null,8,["settings","modelValue"])]),_:1},8,["title","modelValue"])])}}},Fe=ce(Pe,[["__scopeId","data-v-2b625646"]]);export{Fe as default};
