var X=Object.defineProperty;var P=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var U=(u,n,t)=>n in u?X(u,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[n]=t,S=(u,n)=>{for(var t in n||(n={}))Z.call(n,t)&&U(u,t,n[t]);if(P)for(var t of P(n))ee.call(n,t)&&U(u,t,n[t]);return u};var v=(u,n,t)=>new Promise((D,y)=>{var l=s=>{try{p(t.next(s))}catch(m){y(m)}},k=s=>{try{p(t.throw(s))}catch(m){y(m)}},p=s=>s.done?D(s.value):Promise.resolve(s.value).then(l,k);p((t=t.apply(u,n)).next())});import{_ as te,g as ae,r as c,J as oe,Y as le,d,M as ne,c as se,o as x,s as T,l as re,e as q,f as a,N as z,h as r,k as V,O as ie,E as ce,D as w}from"./index-LUiqg7zx.js";import ue from"./index-BzwtcKOi.js";import de from"./index-Bc25mPWH.js";import{a as pe,c as me,e as ge,f as fe}from"./index-BlrrpmcP.js";import"./index-CegAYL2H.js";import"./index-CPEdGia4.js";const _e={class:"app-container"},ve={class:"list-container"},ye={class:"dialog-footer"},be={__name:"food",setup(u){const{proxy:n}=ae(),{sys_food_type:t}=n.useDict("sys_food_type"),D=c([{type:"input",prop:"name",label:"食材名称",placeholder:"请输入食材名称"},{type:"select",prop:"categoryId",label:"食材分类",placeholder:"请选择食材分类",options:[{label:"未处理",value:"0"},{label:"已处理",value:"1"}]}]),y=c([{type:"select",prop:"categoryId",label:"食材分类",width:24,formItemProps:{placeholder:"请选择食材分类"},options:[],rule:[{required:!0,message:"请选择食材分类",trigger:"change"}]},{type:"input",prop:"name",label:"食材名称",width:24,formItemProps:{placeholder:"请输入食材名称"},rule:[{required:!0,message:"请输入食材名称",trigger:"blur"}]}]),l=oe({tableData:[],total:0,formData:{}}),k=c([]),p=c(!0),s=c({pageNum:1,pageSize:10}),m=c({}),b=c(!1),N=c(!0),h=c(""),g=c(!1),I=c(null),f=()=>v(this,null,function*(){b.value=!0;try{let e=yield pe(S(S({},s.value),m.value));l.tableData=e.rows,l.total=e.total,b.value=!1}catch(e){b.value=!1}}),M=e=>v(this,null,function*(){b.value=!0,m.value=e,f()}),$=e=>{k.value=e.map(o=>o.id),N.value=!e.length},L=()=>{h.value="新增食材",g.value=!0},A=e=>{h.value="修改食材",g.value=!0,l.formData=S({},e)},B=e=>{ce.confirm("是否确认删除该备忘录？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>v(this,null,function*(){let o=e.id||k.value;yield me({id:o}),f(),w({type:"success",message:"删除成功"})})).catch(()=>{w({type:"info",message:"取消删除"})})},H=()=>v(this,null,function*(){I.value.submitRef().then(e=>v(this,null,function*(){e&&(g.value=!1,h.value=="新增食材"?(yield ge(l.formData),w.success("新增成功")):h.value=="修改食材"&&(yield fe(l.formData),w.success("修改成功")),f())}))}),J=()=>{g.value=!1,w.info("取消")},O=()=>{l.formData={}};return f(),le(()=>{l.tableData=l.tableData.map(e=>(e.categoryName=t.value.find(o=>o.value==e.categoryId).label,e)),D.value.find(e=>e.prop=="categoryId").options=t.value,y.value.find(e=>e.prop=="categoryId").options=t.value}),(e,o)=>{const _=d("el-button"),E=d("el-col"),Q=d("right-toolbar"),R=d("el-row"),C=d("el-table-column"),F=d("el-tooltip"),Y=d("el-table"),j=d("pagination"),G=d("el-dialog"),K=ne("loading");return x(),se("div",_e,[p.value?(x(),T(ue,{key:0,settings:D.value,onHandleSearch:M},null,8,["settings"])):re("",!0),q("div",ve,[a(R,{gutter:10,class:"mb8"},{default:r(()=>[a(E,{span:1.5},{default:r(()=>[a(_,{type:"primary",plain:"",icon:"Plus",onClick:L},{default:r(()=>[V("新增")]),_:1})]),_:1}),a(E,{span:1.5},{default:r(()=>[a(_,{type:"danger",plain:"",icon:"Delete",disabled:N.value,onClick:B},{default:r(()=>[V("删除")]),_:1},8,["disabled"])]),_:1}),a(Q,{showSearch:p.value,"onUpdate:showSearch":o[0]||(o[0]=i=>p.value=i),onQueryTable:f},null,8,["showSearch"])]),_:1}),z((x(),T(Y,{data:l.tableData,onSelectionChange:$},{default:r(()=>[a(C,{type:"selection",width:"50",align:"center"}),a(C,{label:"食材名称",align:"center",prop:"name"}),a(C,{label:"食材分类",align:"center",prop:"categoryName"}),a(C,{label:"操作",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:r(i=>[a(F,{content:"修改",placement:"top"},{default:r(()=>[a(_,{link:"",type:"primary",icon:"Edit",onClick:W=>A(i.row)},null,8,["onClick"])]),_:2},1024),a(F,{content:"删除",placement:"top"},{default:r(()=>[a(_,{link:"",type:"primary",icon:"Delete",onClick:W=>B(i.row)},null,8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[K,b.value]]),z(a(j,{total:l.total,page:s.value.pageNum,"onUpdate:page":o[1]||(o[1]=i=>s.value.pageNum=i),limit:s.value.pageSize,"onUpdate:limit":o[2]||(o[2]=i=>s.value.pageSize=i),onPagination:f},null,8,["total","page","limit"]),[[ie,l.total>0]])]),a(G,{title:h.value,modelValue:g.value,"onUpdate:modelValue":o[4]||(o[4]=i=>g.value=i),width:"30%",onClosed:O,draggable:"","destroy-on-close":!0},{footer:r(()=>[q("div",ye,[a(_,{type:"primary",onClick:H},{default:r(()=>[V("确 定")]),_:1}),a(_,{onClick:J},{default:r(()=>[V("取 消")]),_:1})])]),default:r(()=>[a(de,{settings:y.value,modelValue:l.formData,"onUpdate:modelValue":o[3]||(o[3]=i=>l.formData=i),ref_key:"base_form",ref:I},null,8,["settings","modelValue"])]),_:1},8,["title","modelValue"])])}}},xe=te(be,[["__scopeId","data-v-43a3cc5e"]]);export{xe as default};
