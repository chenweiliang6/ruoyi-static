var ie=Object.defineProperty;var H=Object.getOwnPropertySymbols;var ue=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var J=(o,i,n)=>i in o?ie(o,i,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[i]=n,P=(o,i)=>{for(var n in i||(i={}))ue.call(i,n)&&J(o,n,i[n]);if(H)for(var n of H(i))pe.call(i,n)&&J(o,n,i[n]);return o};var m=(o,i,n)=>new Promise((S,w)=>{var s=p=>{try{f(n.next(p))}catch(v){w(v)}},V=p=>{try{f(n.throw(p))}catch(v){w(v)}},f=p=>p.done?S(p.value):Promise.resolve(p.value).then(s,V);f((n=n.apply(o,i)).next())});import{y as B,_ as ce,g as de,r as u,J as me,x as fe,Y as ge,d as c,M as ve,c as L,o as g,s as N,l as T,e as z,f as a,N as O,h as r,k as U,A as _e,i as ye,O as he,E as we,D}from"./index-Cvg2Ob7C.js";import be from"./index-BhH4B5Js.js";import ke from"./index-DjMwqi4L.js";import{g as Ce}from"./user-fyIOEaJ9.js";import De from"./index-BtRkZc2-.js";import"./index-DUksNF2m.js";function Se(o){let i={pageNum:o.pageNum,pageSize:o.pageSize};return B({url:"/wallpaper/list",method:"post",data:o,params:i})}function Ve(o){return B({url:"/wallpaper/add",method:"post",data:o})}function xe(o){return B({url:"/wallpaper/update",method:"put",data:o})}function Pe(o){return B({url:"/wallpaper/"+o.id,method:"delete"})}const Ne={class:"app-container"},Ue={class:"list-container"},Be=["src","onClick"],Ie={key:1},Le={class:"dialog-footer"},Te={__name:"index",setup(o){const{proxy:i}=de(),{sys_wallpaper_type:n}=i.useDict("sys_wallpaper_type"),S=u([{type:"input",prop:"name",label:"壁纸名称",placeholder:"请输入壁纸名称"},{type:"select",prop:"type",label:"类型",placeholder:"请选择类型",options:[]}]),w=u([{type:"input",prop:"name",label:"壁纸名称",width:12,formItemProps:{placeholder:"请输入壁纸名称"},rule:[{required:!0,message:"请输入壁纸名称",trigger:"blur"}]},{type:"select",prop:"type",label:"类型",width:12,formItemProps:{placeholder:"请选择类型"},options:[],rule:[{required:!0,message:"请选择类型",trigger:"change"}]},{type:"upload",uploadType:"img",listType:"picture-card",limit:1,prop:"fileList",label:"图片",width:24,rule:[{required:!0,message:"请上传壁纸图片",trigger:"change"}]}]),s=me({tableData:[],total:0,formData:{}}),V=u([]),f=u(!0),p=u({pageNum:1,pageSize:10}),v=u({}),b=u(!1),E=u(!0),Q=u({}),k=u(""),_=u(!1),$=u(null),I=u(!1),M=u(""),R=u("0"),q=u([]),Y=()=>m(this,null,function*(){let e=yield Ce();Q.value=e.data}),y=()=>m(this,null,function*(){b.value=!0;try{let e=yield Se(P(P({},p.value),v.value));s.tableData=e.rows,s.total=e.total,b.value=!1}catch(e){b.value=!1}}),j=e=>m(this,null,function*(){b.value=!0,v.value=e,y()}),G=e=>{V.value=e.map(l=>l.id),E.value=!e.length},K=()=>{k.value="新增壁纸",_.value=!0},W=e=>{k.value="修改壁纸",_.value=!0,s.formData=P({},e),s.formData.fileList=[{url:s.formData.url}]},A=e=>{we.confirm("是否确认删除该壁纸？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>m(this,null,function*(){let l=e.id||V.value;yield Pe({id:l}),y(),D({type:"success",message:"删除成功"})})).catch(()=>{D({type:"info",message:"取消删除"})})},X=()=>m(this,null,function*(){$.value.submitRef().then(e=>m(this,null,function*(){var l;e&&(_.value=!1,s.formData.url=(l=s.formData.fileList)!=null&&l.length?s.formData.fileList[0].url:"",delete s.formData.fileList,k.value=="新增壁纸"?(yield Ve(s.formData),D.success("新增成功")):k.value=="修改壁纸"&&(yield xe(s.formData),D.success("修改成功")),y())}))}),Z=()=>{_.value=!1,D.info("取消")},ee=()=>{s.formData={}},te=(e,l)=>{q.value=[{url:e}],M.value=l,I.value=!0};return fe(()=>m(this,null,function*(){yield Y(),yield y()})),ge(()=>{S.value.find(e=>e.prop=="type").options=n.value,w.value.find(e=>e.prop=="type").options=n.value}),(e,l)=>{const d=c("el-button"),F=c("el-col"),ae=c("right-toolbar"),le=c("el-row"),C=c("el-table-column"),x=c("el-tooltip"),oe=c("el-table"),ne=c("pagination"),se=c("el-dialog"),re=ve("loading");return g(),L("div",Ne,[f.value?(g(),N(be,{key:0,settings:S.value,onHandleSearch:j},null,8,["settings"])):T("",!0),z("div",Ue,[a(le,{gutter:10,class:"mb8"},{default:r(()=>[a(F,{span:1.5},{default:r(()=>[a(d,{type:"primary",plain:"",icon:"Plus",onClick:K},{default:r(()=>[U("新增")]),_:1})]),_:1}),a(F,{span:1.5},{default:r(()=>[a(d,{type:"danger",plain:"",icon:"Delete",disabled:E.value,onClick:A},{default:r(()=>[U("删除")]),_:1},8,["disabled"])]),_:1}),a(ae,{showSearch:f.value,"onUpdate:showSearch":l[0]||(l[0]=t=>f.value=t),onQueryTable:y},null,8,["showSearch"])]),_:1}),O((g(),N(oe,{data:s.tableData,onSelectionChange:G},{default:r(()=>[a(C,{type:"selection",width:"50",align:"center"}),a(C,{label:"名称",align:"center",prop:"name"}),a(C,{label:"图片",align:"center",prop:"url"},{default:r(t=>[t.row.url?(g(),L("img",{key:0,src:t.row.url,style:{width:"60px",height:"60px",cursor:"pointer"},onClick:h=>te(t.row.url)},null,8,Be)):(g(),L("span",Ie,"暂无"))]),_:1}),a(C,{label:"类型",align:"center",prop:"type"},{default:r(t=>[z("span",null,_e(ye(n).find(h=>h.value==t.row.type).label),1)]),_:1}),a(C,{label:"操作",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:r(t=>[a(x,{content:"修改",placement:"top"},{default:r(()=>[a(d,{link:"",type:"primary",icon:"Edit",onClick:h=>W(t.row)},null,8,["onClick"])]),_:2},1024),a(x,{content:"删除",placement:"top"},{default:r(()=>[a(d,{link:"",type:"primary",icon:"Delete",onClick:h=>A(t.row)},null,8,["onClick"])]),_:2},1024),t.row.status=="0"?(g(),N(x,{key:0,content:"启用",placement:"top"},{default:r(()=>[a(d,{link:"",type:"primary",icon:"CircleCheck",onClick:h=>e.handleChangeStatus1(t.row)},null,8,["onClick"])]),_:2},1024)):T("",!0),t.row.status=="1"?(g(),N(x,{key:1,content:"停用",placement:"top"},{default:r(()=>[a(d,{link:"",type:"primary",icon:"CircleClose",onClick:h=>e.handleChangeStatus0(t.row)},null,8,["onClick"])]),_:2},1024)):T("",!0)]),_:1})]),_:1},8,["data"])),[[re,b.value]]),O(a(ne,{total:s.total,page:p.value.pageNum,"onUpdate:page":l[1]||(l[1]=t=>p.value.pageNum=t),limit:p.value.pageSize,"onUpdate:limit":l[2]||(l[2]=t=>p.value.pageSize=t),onPagination:y},null,8,["total","page","limit"]),[[he,s.total>0]])]),a(se,{title:k.value,modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=t=>_.value=t),width:"35%",onClosed:ee,draggable:"","destroy-on-close":!0},{footer:r(()=>[z("div",Le,[a(d,{type:"primary",onClick:X},{default:r(()=>[U("确 定")]),_:1}),a(d,{onClick:Z},{default:r(()=>[U("取 消")]),_:1})])]),default:r(()=>[a(ke,{settings:w.value,modelValue:s.formData,"onUpdate:modelValue":l[3]||(l[3]=t=>s.formData=t),ref_key:"base_form",ref:$},null,8,["settings","modelValue"])]),_:1},8,["title","modelValue"]),a(De,{modelValue:I.value,"onUpdate:modelValue":l[5]||(l[5]=t=>I.value=t),size:"auto","img-list":q.value,title:M.value,"init-number":R.value},null,8,["modelValue","img-list","title","init-number"])])}}},He=ce(Te,[["__scopeId","data-v-2dec8c87"]]);export{He as default};
