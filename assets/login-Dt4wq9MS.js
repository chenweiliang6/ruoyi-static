var F=Object.defineProperty,L=Object.defineProperties;var O=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var V=(o,s,t)=>s in o?F(o,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[s]=t,M=(o,s)=>{for(var t in s||(s={}))P.call(s,t)&&V(o,t,s[t]);if(k)for(var t of k(s))Q.call(s,t)&&V(o,t,s[t]);return o},q=(o,s)=>L(o,O(s));import{_ as T,b as $,u as D,a as G,g as H,r as m,w as J,d as c,c as h,e as b,f as a,h as i,i as n,j as W,k as C,l as X,m as Y,o as y,n as u,p as Z,q as ee}from"./index-CIuGMKj0.js";import{d as oe,e as R}from"./jsencrypt-SgG7V4Th.js";const I=o=>(Z("data-v-450f13b9"),o=o(),ee(),o),se={class:"login"},te={class:"login-card"},re=I(()=>b("h3",{class:"title"},"后台管理系统",-1)),ae={key:0},ne={key:1},le={key:0,style:{float:"right"}},ie=I(()=>b("div",{class:"el-login-footer"},[b("span",null,"Copyright © 2024 cwl All Rights Reserved.")],-1)),ue={__name:"login",setup(o){const s=$(),t=D(),S=G(),{proxy:B}=H(),e=m({username:"",password:"",rememberMe:!1,code:"",uuid:""}),N={username:[{required:!0,trigger:"blur",message:"请输入您的账号"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"}],code:[{required:!0,trigger:"change",message:"请输入验证码"}]};m("");const g=m(!1),U=m(!0),z=m(!1),w=m(void 0);J(t,l=>{console.log(l,"newRoute"),w.value=l.query&&l.query.redirect},{immediate:!0});function x(){B.$refs.loginRef.validate(l=>{if(l){g.value=!0,e.value.rememberMe?(u.set("username",e.value.username,{expires:30}),u.set("password",R(e.value.password),{expires:30}),u.set("rememberMe",e.value.rememberMe,{expires:30})):(u.remove("username"),u.remove("password"),u.remove("rememberMe"));const r=q(M({},e.value),{password:R(e.value.password)});s.login(r).then(()=>{const d=t.query,v=Object.keys(d).reduce((p,_)=>(_!=="redirect"&&(p[_]=d[_]),p),{});console.log(w.value,"redirect"),S.push({path:w.value||"/",query:v})}).catch(()=>{g.value=!1,U.value})}})}function K(){const l=u.get("username"),r=u.get("password"),d=u.get("rememberMe");e.value={username:l===void 0?e.value.username:l,password:r===void 0?e.value.password:oe(r),rememberMe:d===void 0?!1:!!d}}return K(),(l,r)=>{const d=c("svg-icon"),v=c("el-input"),p=c("el-form-item"),_=c("el-checkbox"),j=c("el-button"),E=c("router-link"),A=c("el-form");return y(),h("div",se,[b("div",te,[a(A,{ref:"loginRef",model:n(e),rules:N,class:"login-form","label-position":"top"},{default:i(()=>[re,a(p,{prop:"username",label:"账号"},{default:i(()=>[a(v,{modelValue:n(e).username,"onUpdate:modelValue":r[0]||(r[0]=f=>n(e).username=f),type:"text",size:"large","auto-complete":"off",placeholder:"账号"},{prefix:i(()=>[a(d,{"icon-class":"user",class:"el-input__icon input-icon"})]),_:1},8,["modelValue"])]),_:1}),a(p,{prop:"password",label:"密码"},{default:i(()=>[a(v,{modelValue:n(e).password,"onUpdate:modelValue":r[1]||(r[1]=f=>n(e).password=f),type:"password",size:"large","auto-complete":"off",placeholder:"密码",onKeyup:W(x,["enter"])},{prefix:i(()=>[a(d,{"icon-class":"password",class:"el-input__icon input-icon"})]),_:1},8,["modelValue","onKeyup"])]),_:1}),a(_,{modelValue:n(e).rememberMe,"onUpdate:modelValue":r[2]||(r[2]=f=>n(e).rememberMe=f),style:{margin:"0px 0px 25px 0px"}},{default:i(()=>[C("记住密码")]),_:1},8,["modelValue"]),a(p,{style:{width:"100%"}},{default:i(()=>[a(j,{loading:n(g),size:"large",type:"primary",style:{width:"100%"},onClick:Y(x,["prevent"])},{default:i(()=>[n(g)?(y(),h("span",ne,"登 录 中...")):(y(),h("span",ae,"登 录"))]),_:1},8,["loading","onClick"]),n(z)?(y(),h("div",le,[a(E,{class:"link-type",to:"/register"},{default:i(()=>[C("立即注册")]),_:1})])):X("",!0)]),_:1})]),_:1},8,["model"])]),ie])}}},me=T(ue,[["__scopeId","data-v-450f13b9"]]);export{me as default};
